(function(e){"use strict";function a(e,t){return s.test(e)||(t||(t={}),t.callback||(t.callback=c())),t&&(e=l(e,t)),new u(function(t,n){i(e,function(e,r){return e?n(e):t(r)})})}function f(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);return t.join("&")}function l(e,t){var n=o.test(e)?"":"?";return e+n+f(t)}function c(){return"jsonpCallback_"+Math.random().toString().replace(".","")}var t=e.jsonpClient,n=typeof process!="undefined"?process.browser:typeof window!="undefined",r,i,s=/[\?|&]callback=([a-z0-9_]+)/i,o=/\?.+=.+/,u=e.Promise||typeof require=="function"&&require("promise");if(!u)throw new Error("jsonp-client requires Promise for work");a.noConflict=function(){return e.jsonpClient=t,a},r=function(){var e,t,n=document.getElementsByTagName("head")[0];return t=function(e,t){var r=document.createElement("script"),i=!1;r.src=e,r.async=!0,r.onload=r.onreadystatechange=function(){!i&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")&&(i=!0,r.onload=r.onreadystatechange=null,r&&r.parentNode&&r.parentNode.removeChild(r),t())},n.appendChild(r)},e=function(e,t){var n=e.match(s);if(!n)return t(new Error("Could not find callback on URL"));t(null,n[1])},function(n,r){e(n,function(e,i){var s,o=window[i];if(e)return r(e);window[i]=function(e){s=e},t(n,function(e){!e&&!s&&(e=new Error("Calling to "+i+" did not returned a JSON response. "+"Make sure the callback "+i+" exists and is properly formatted."));if(o)window[i]=o;else try{delete window[i]}catch(t){window[i]=undefined}r(e,s)})})}},i=n?r():require("./jsonp-node.js"),typeof module!="undefined"&&module.exports?module.exports=a:e.jsonpClient=a})(global||window);